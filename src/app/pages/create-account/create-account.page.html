<ion-content class="create">
  <div class="layout">
    <!-- Branding -->
    <div class="brand">
      <div class="brand-circle">
        <img 
          src="../../../assets/icon/UberGifts-bright-logo.png" 
          alt="Logo de Cautelapp" 
          class="brand-logo" 
        />
      </div>
    </div>

    <!-- Create Account Card -->
    <div class="card">
      <h1 class="title">Crear Cuenta</h1>

      <form (ngSubmit)="registrarse()" #createForm="ngForm">
        <!-- Nombre Field -->
        <ion-item 
          class="field" 
          lines="none"
        >
          <ion-label position="stacked">
            <ion-icon name="person-outline" slot="start"></ion-icon>
            Nombre
          </ion-label>
          <ion-input
            type="text"
            name="nombre"
            placeholder="Tu nombre completo"
            [(ngModel)]="nombre"
            required
            aria-label="Nombre"
              class="login-input"
            ></ion-input>
        </ion-item>

        <!-- Email Field -->
        <ion-item 
          class="field" 
          lines="none"
        >
          <ion-label position="stacked">
            <ion-icon name="mail-outline" slot="start"></ion-icon>
            Correo electrónico
          </ion-label>
          <ion-input
            type="email"
            name="email"
            placeholder="tu@correo.com"
            [(ngModel)]="email"
            inputmode="email"
            autocomplete="email"
            required
            aria-label="Correo electrónico"
              class="login-input"
            ></ion-input>
        </ion-item>

        <!-- Password Field -->
        <ion-item 
          class="field" 
          lines="none"
        >
          <ion-label position="stacked">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            Contraseña
          </ion-label>
          <ion-input
            [type]="passwordVisible ? 'text' : 'password'"
            name="password"
            placeholder="••••••••"
            [(ngModel)]="password"
            autocomplete="new-password"
            required
            minlength="6"
            aria-label="Contraseña"
              class="login-input"
            >
            <ion-icon 
              slot="end"
              [name]="passwordVisible ? 'eye-off-outline' : 'eye-outline'"
              class="toggle-icon"
              (click)="togglePassword()"
              [attr.aria-label]="passwordVisible ? 'Ocultar contraseña' : 'Mostrar contraseña'"
            ></ion-icon>
          </ion-input>
        </ion-item>

        <!-- Confirm Password Field -->
        <ion-item 
          class="field" 
          lines="none"
          [class.ion-invalid]="passwordMatchError"
        >
          <ion-label position="stacked">
            <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
            Confirmar Contraseña
          </ion-label>
          <ion-input
            [type]="passwordVisible ? 'text' : 'password'"
            name="confirmPassword"
            placeholder="••••••••"
            [(ngModel)]="confirmPassword"
            autocomplete="new-password"
            required
            minlength="6"
            (ionBlur)="validatePasswordMatch()"
            aria-label="Confirmar Contraseña"
              class="login-input"
            ></ion-input>
        </ion-item>
        <p 
          *ngIf="passwordMatchError" 
          class="error"
        >{{ passwordMatchError }}</p>

        <!-- Submit Button -->
        <ion-button 
            expand="block" 
            class="primary login-input" 
            type="submit"
            [disabled]="!canSubmit || loading"
            aria-label="Crear cuenta"
          >
            <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
            <span *ngIf="!loading">Crear Cuenta</span>
          </ion-button>

        <!-- Login Link -->
        <p class="aux">
          ¿Ya tienes cuenta?
          <button 
            type="button"
            class="link" 
            (click)="goLogin()"
            aria-label="Ir a inicio de sesión"
          >
            Inicia sesión aquí
          </button>
        </p>
      </form>
    </div>
  </div>
</ion-content>
